$(document).ready(function(){for(var c=["#5eeccc","rgb(247, 61, 98)","#3ac972","#f359a8"],f=[32,16,13],b=65;91>b;b++)f.push(b);for(var g=[68,70,74,75],h=[68,69,70,82,83,87],j=[73,74,75,76,79,85],d={16:"shift",13:"enter",17:"ctrl",32:"space"},b=0;26>b;b++)d[b+65]="abcdefghijklmnopqrstuvwxyz"[b];for(var s={68:"d",70:"f",74:"j",75:"k"},t=[[81,65,90],[87,83,88],[69,68,67],[82,70,86]],u=function(){var a=Math.floor(Math.random()*c.length),e=Math.floor(Math.random()*f.length);if(0===e){var b=Math.floor(2*
Math.random())+1;$("#space"+b).css("background-color",c[a])}else $("#"+d[f[e]]).css("background-color",c[a]);current=f[e]},v=function(){var a=Math.floor(Math.random()*c.length),e=Math.floor(Math.random()*g.length);$("#easy"+s[g[e]]).css("background-color",c[a]);current=g[e]},k=function(){var a=Math.floor(Math.random()*c.length),e=Math.floor(Math.random()*h.length),b=Math.floor(Math.random()*j.length);$("#vs"+d[h[e]]).css("background-color",c[a]);$("#vs"+d[j[b]]).css("background-color",c[a]);current1=
h[e];current2=j[b]},w=function(){32!==current?$("#"+d[current]).css("background-color","#fff"):($("#space1").css("background-color","#fff"),$("#space2").css("background-color","#fff"))},x=function(){$("#easy"+s[current]).css("background-color","#fff")},l=function(){$("#vs"+d[current1]).css("background-color","#fff");$("#vs"+d[current2]).css("background-color","#fff")},A=function(){var a=(new Date).getTime(),a=Math.floor((a-start)/1E3);gametime-a<left&&(left=gametime-a,$("#timer").text(left),0===left?
(finished=!0,clearInterval(timer),$("#timer").text("Time's up!"),$("#easy_score_value").text(score),$("#easy_score").css("visibility","visible"),$("#caption").text("Press \u2190 (left arrow) to go to the menu \u2193 (down arrow) to retry.").css({opacity:1,visibility:"visible"}).addClass("fadein"),x()):left===Math.floor(gametime/3)&&$("#timer").addClass("red_timer"))},B=function(){var a=(new Date).getTime(),a=Math.floor((a-start)/1E3);gametime-a<left&&(left=gametime-a,$("#timer").text(left),0===left?
(finished=!0,clearInterval(timer),$("#timer").text("Time's up!"),$("#vs_score_left_value").text(score1),$("#vs_score_right_value").text(score2),$("#vs_score_left").css("visibility","visible"),$("#vs_score_right").css("visibility","visible"),$("#caption").text("Press \u2190 (left arrow) to go to the menu \u2193 (down arrow) to retry.").css({opacity:1,visibility:"visible"}).addClass("fadein"),l()):left===Math.floor(gametime/3)&&$("#timer").addClass("red_timer"))},m=function(){game_on="playing";mode=
"solo";score=0;started=!1;types=0;finished=!1;$("#menu").addClass("fadeout");$("#solo").css("visibility","visible").addClass("fadein");$("#caption").text("Hit as many colored blocks as you can without making a mistake. Press any key to start!").css({opacity:1,visibility:"visible"}).addClass("fadein").removeClass("close");$("#solo_score").css("visibility","hidden");$("#solo .block").css("color","#000");ga("send","pageview","/#hard")},n=function(){game_on="playing";mode="easy";score=0;started=!1;left=
gametime;types=0;finished=!1;$("#menu").addClass("fadeout");$("#easy").css("visibility","visible").addClass("fadein");$("#caption").text("Hit as many colored blocks as you can before the time runs out. Press any key to start!").css({opacity:1,visibility:"visible"}).addClass("fadein").removeClass("close");$("#timer").text(gametime);$("#timer").css("visibility","visible").addClass("fadein").removeClass("red_timer");$("#easy_score").css("visibility","hidden");$("#easy .block").css("color","#000");ga("send",
"pageview","/#easy")},p=function(){game_on="playing";mode="vs";score2=score1=0;started=!1;left=gametime;types=0;finished=!1;$("#menu").addClass("fadeout");$("#vs").css("visibility","visible").addClass("fadein");$("#caption").text("The one to hit the colored block in their side first wins a round. Win as many rounds as you can before the time runs out. Press any key to start!").css({opacity:1,visibility:"visible"}).addClass("fadein").removeClass("close");$("#timer").text(gametime);$("#timer").css("visibility",
"visible").addClass("fadein").removeClass("red_timer");$("#vs_score_left").css("visibility","hidden");$("#vs_score_right").css("visibility","hidden");$("#vs .block").css("color","#000");ga("send","pageview","/#vs")},q=function(){game_on="playing";finished=started=!1;typed="";$("#stories").removeClass("close");story_index=Math.floor(Math.random()*$("#storybook pre").length);var a=$("#storybook pre")[story_index],b=a.innerText.split(/\n| /);words=[];words.push($(a).data("title"));for(a=0;a<b.length;a++)""!==
b[a]&&words.push(b[a]);$("#phrase").text("").removeClass().show();$("#story_title").text("").removeClass();$("#complete_story").text("").css("visibility","hidden");$("#menu").addClass("fadeout");$("#stories").addClass("fadein");$("#caption").text("Discover the story by typing it. Press any key to start!").css({opacity:1,visibility:"visible"}).addClass("white fadein").removeClass("close");ga("send","pageview","/#stories")},y=function(a){a=void 0!==a?1:Math.floor(Math.random()*Math.min(5,words.length))+
1;for(var b=words.slice(0,a).join(" "),c="",d=0;d<b.length;d++)c+="<span>"+b[d]+"</span>";words.splice(0,a);$("#phrase").html(c).addClass("fadein");phrase=b},r=function(){game_on="playing";mode="circuits";finished=started=!1;next_move=current_move=prev_move=0;$("#circuits_result").css("visibility","hidden");$("#menu").addClass("fadeout");$("#circuits").css("visibility","visible").addClass("fadein");$("#caption").text("Press and hold all the colored blocks using one hand. Press any key to start!").css({opacity:1,
visibility:"visible"}).addClass("fadein").removeClass("close");$("#circuit_score").css("visibility","hidden");$("#circuits .block").css("background-color","#fff");ga("send","pageview","/#circuits")},z=function(){for(var a=Math.floor(Math.random()*c.length),b=Math.floor(4*Math.random()),f=Math.floor(3*Math.random()),b=t[b][f];b===next_move||b===current_move||b===prev_move;)b=Math.floor(4*Math.random()),f=Math.floor(3*Math.random()),b=t[b][f];prev_move=current_move;$("#c_"+d[prev_move]).css("background-color",
"#fff");current_move=next_move;next_move=b;$("#c_"+d[next_move]).css("background-color",c[a])},b=0;10>b;b++)$("<div/>",{id:"qwertyuiop"[b],"class":"block"}).text("qwertyuiop"[b]).appendTo("#row1");for(b=0;9>b;b++)$("<div/>",{id:"asdfghjkl"[b],"class":"block"}).text("asdfghjkl"[b]).appendTo("#row2");$("<div/>",{id:"enter","class":"block"}).text("enter").appendTo("#row2");for(b=0;7>b;b++)$("<div/>",{id:"zxcvbnm"[b],"class":"block"}).text("zxcvbnm"[b]).appendTo("#row3");$("<div/>",{id:"space1","class":"block"}).text("space").appendTo("#row3");
$("<div/>",{id:"space2","class":"block"}).text("space").appendTo("#row3");$("<div/>",{id:"shift","class":"block"}).text("shift").appendTo("#row3");$(document).keydown(function(a){"playing"===game_on?"easy"===mode?!1===started?(started=!0,start=(new Date).getTime(),timer=setInterval(A,500),$("#caption").css("opacity",0),v()):finished?40===a.which?n():37===a.which&&(game_on="menu",$("#easy").addClass("fadeout"),$("#timer").text("").css({visibility:"hidden"}).addClass("fadeout"),$("#menu").css({visibility:"visible",
opacity:1}).addClass("fadein"),$("#easy_score").css("visibility","hidden"),ga("send","pageview","/#menu")):(a.which===current?(score+=100,x(),v()):score-=100,types++,11>types&&$("#easy .block").css("color","rgba(0, 0, 0, "+(1-0.1*types)+")")):"solo"===mode?!1===started?(started=!0,$("#caption").css("opacity",0),u()):finished?40===a.which?m():37===a.which&&(game_on="menu",$("#solo").addClass("fadeout"),$("#menu").css({visibility:"visible",opacity:1}).addClass("fadein"),$("#solo_score").css("visibility",
"hidden"),ga("send","pageview","/#menu")):(a.which===current?(score+=100,w(),u()):(finished=!0,$("#solo_score_value").text(score),$("#solo_score").css("visibility","visible"),$("#caption").text("Press \u2190 (left arrow) to go to the menu \u2193 (down arrow) to retry.").css({opacity:1,visibility:"visible"}).addClass("fadein"),w()),types++,11>types&&$(".block").css("color","rgba(0, 0, 0, "+(1-0.1*types)+")")):"vs"===mode?!1===started?(started=!0,start=(new Date).getTime(),timer=setInterval(B,500),
$("#caption").css("opacity",0),k()):finished?40===a.which?p():37===a.which&&(game_on="menu",$("#vs").addClass("fadeout"),$("#timer").text("").css({visibility:"hidden"}).addClass("fadeout"),$("#menu").css({visibility:"visible",opacity:1}).addClass("fadein"),$("#vs_score_left").css("visibility","hidden"),$("#vs_score_right").css("visibility","hidden"),$("#prophecy").animate({volume:0},1E3,function(){$(this)[0].pause();$("#halfawake")[0].play();$("#halfawake").animate({volume:0},0).animate({volume:1},
5E3)}),ga("send","pageview","/#menu")):(a.which===current1?(score1+=100,l(),k()):a.which===current2&&(score2+=100,l(),k()),types++,11>types&&$("#vs .block").css("color","rgba(0, 0, 0, "+(1-0.1*types)+")")):"stories"===mode?finished&&(40===a.which?q():37===a.which&&(game_on="menu",mode="",$("#stories").addClass("fadeout close"),$("#caption").removeClass("white"),$("#complete_story").text(""),$("#story_title").text(""),$("#menu").css({visibility:"visible",opacity:1}).addClass("fadein"),$("#ambient").animate({volume:0},
1E3,function(){$(this)[0].pause();$("#halfawake")[0].play();$("#halfawake").animate({volume:0},0).animate({volume:1},5E3)}),ga("send","pageview","/#menu"))):"circuits"===mode&&(!1===started?($("#caption").css("opacity",0),z(),started=!0):finished?40===a.which?r():37===a.which&&(game_on="menu",$("#circuits").addClass("fadeout"),$("#menu").css({visibility:"visible",opacity:1}).addClass("fadein"),$("#circuits_result").css("visibility","hidden"),ga("send","pageview","/#menu")):a.which===next_move&&z()):
"menu"===game_on?70===a.which?m():65===a.which?n():74===a.which?($("#halfawake").animate({volume:0},1E3,function(){$(this)[0].pause();$("#prophecy")[0].play();$("#prophecy").animate({volume:0},0).animate({volume:1},5E3)}),p()):83===a.which?($("#halfawake").animate({volume:0},1E3,function(){$(this)[0].pause();$("#ambient")[0].play();$("#ambient").animate({volume:0},0).animate({volume:1},5E3)}),q()):67===a.which&&r():"logo"===game_on&&($("#logo-op").css("opacity",0).addClass("close"),$("#caption").css("opacity",
0).addClass("close"),$("#title").addClass("fadein").css("visibility","visible"),$("#menu").addClass("fadein"),game_on="menu")});$("#logo-op").on("webkitTransitionEnd",function(){$(this).hasClass("close")&&($(this).css("visibility","hidden"),$("#logo").removeClass("logo-anim close"))});$("#caption").on("webkitTransitionEnd",function(){$(this).hasClass("close")&&($(this).css({visibility:"hidden"}),$(this).removeClass("fadein close"))});$("#logo-op").on("click",function(){"logo"===game_on&&($("#logo-op").css("opacity",
0).addClass("close"),$("#caption").css("opacity",0).addClass("close"),$("#title").addClass("fadein").css("visibility","visible"),$("#menu").addClass("fadein"),game_on="menu")});$("#menu").on("webkitAnimationEnd",function(){$(this).removeClass();"menu"===game_on?$("#caption").text("Select with the mouse or the A, F, J, S or C keys.").css({opacity:1,visibility:"visible"}).addClass("fadein"):$(this).css({opacity:0,visibility:"hidden"})});$("#solo").on("webkitAnimationEnd",function(){$(this).removeClass("fadein fadeout");
"menu"===game_on&&$(this).css("visibility","hidden")});$("#easy, #vs, #circuits").on("webkitAnimationEnd",function(){$(this).removeClass("fadein fadeout");"menu"===game_on&&$(this).css("visibility","hidden")});$("#single_option").click(function(){m()});$("#easy_option").click(function(){n()});$("#vs_option").click(function(){$("#halfawake").animate({volume:0},1E3,function(){$(this)[0].pause();$("#prophecy")[0].play();$("#prophecy").animate({volume:0},0).animate({volume:1},5E3)});p()});$("#stories_option").click(function(){$("#halfawake").animate({volume:0},
1E3,function(){$(this)[0].pause();$("#ambient")[0].play();$("#ambient").animate({volume:0},0).animate({volume:1},5E3)});q()});$("#stories").on("webkitAnimationEnd",function(){$(this).hasClass("close")?($(this).css("visibility","hidden"),$(this).removeClass("fadein close fadeout")):(mode="stories",$(this).css("visibility","visible"))});$("#phrase").on("webkitAnimationEnd",function(){$(this).removeClass("fadein")});$(document).keypress(function(a){"stories"===mode&&"playing"===game_on&&(!1===started?
(started=!0,$("#caption").css("opacity",0),y(!0)):finished||(a=String.fromCharCode(a.which),(typed+a).toUpperCase()===phrase.toUpperCase()?0<words.length?(typed="",y()):(finished=!0,$($("#phrase span")[typed.length]).css("text-shadow","0 -6.4rem 1.1rem #000"),typed="",$("#phrase").text("").hide(),$("#story_title").text($($("#storybook pre")[story_index]).data("title")).addClass("fadein"),$("#complete_story").text($($("#storybook pre")[story_index]).text()).css("visibility","visible").addClass("fadein"),
$("#caption").text("Press \u2190 (left arrow) to go to the menu \u2193 (down arrow) to try another story.").css({opacity:1,visibility:"visible"}).addClass("fadein")):phrase[typed.length].toUpperCase()===a.toUpperCase()&&($($("#phrase span")[typed.length]).css("text-shadow","0 -6.4rem 1.1rem #000"),typed+=a)))});$(document).keyup(function(a){"circuits"===mode&&"playing"===game_on&&a.which===current_move&&(finished=!0,$("#circuits_result").text("Good dance session!").css("visibility","visible"),$("#caption").text("Press \u2190 (left arrow) to go to the menu \u2193 (down arrow) to retry.").css({opacity:1,
visibility:"visible"}).addClass("fadein"))});$("#circuits_option").click(function(){r()})});